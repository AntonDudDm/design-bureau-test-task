
---

# Моделирование отделения КА от ступени РН

**Описание математической модели и алгоритма решения**

## 1. Цель задачи

Промоделировать процесс отделения космического аппарата (КА) от ступени ракеты-носителя (РН) на орбите Земли с учётом:

* гравитационного поля Земли;
* действия пружинного толкателя с конечным временем работы;
* расчёта траекторий, относительного расстояния и относительной скорости;
* получения результатов в виде временных рядов с шагом не более 0.01 с.

Решение реализовано в среде **GNU Octave**.

---

## 2. Принятые допущения

1. КА и РН моделируются как **материальные точки**.
2. Земля рассматривается как центральное гравитирующее тело.
3. Атмосферные и другие внешние возмущения не учитываются.
4. Толкатель моделируется как **линейная пружина**, действующая вдоль фиксированного направления.
5. Направление отделения совпадает с направлением скорости на орбите в момент начала отделения.
6. Система отсчёта — инерциальная геоцентрическая (ECI, J2000).

---

## 3. Обозначения

### Орбитальные элементы

* ($a$) — большая полуось
* ($e$) — эксцентриситет
* ($i$) — наклонение орбиты
* ($\Omega$) — долгота восходящего узла
* ($\omega$) — аргумент перицентра
* ($M$) — средняя аномалия

### Векторные величины

* ($\mathbf r_{lv}, \mathbf v_{lv}$) — положение и скорость ступени РН
* ($\mathbf r_{sc}, \mathbf v_{sc}$) — положение и скорость КА
* ($\mathbf u$) — единичный вектор направления отделения
* ($\mu$) — гравитационный параметр Земли

### Параметры пружины

* ($k$) — жёсткость
* ($L_0$) — длина недеформированной пружины
* ($L_{start}$) — начальная длина
* ($L_{end}$) — конечная длина (момент отключения толкателя)

---

## 4. Системы координат

### 4.1. Инерциальная система координат (ECI)

Используется для интегрирования уравнений движения.
Начало — в центре Земли, оси неподвижны в инерциальном пространстве.

### 4.2. Перифокальная система (PQW)

Используется для перехода от кеплеровых элементов к векторам положения и скорости:

* ось (P) направлена на перицентр;
* ось (Q) лежит в плоскости орбиты и перпендикулярна (P);
* ось (W) совпадает с вектором момента импульса.

---

## 5. Математическая модель

### 5.1. Гравитационное ускорение

Для каждого тела гравитационное возмущение:

$$
\mathbf a_g(\mathbf r) = -\mu \frac{\mathbf r}{|\mathbf r|^3}
$$


### 5.2. Модель пружинного толкателя

Текущая длина вдоль оси отделения:
$$
L(t) = (\mathbf r_{sc} - \mathbf r_{lv}) \cdot \mathbf u
$$

Сила толкателя:

$$
F(t) =
\begin{cases}
k (L_{free} - L), & L < L_{free} \ \text{и}\ L < L_{end} \
0, & \text{иначе}
\end{cases}
$$

Силы на тела:
$$
\mathbf F_{sc} = +F \mathbf u, \quad
\mathbf F_{lv} = -F \mathbf u
$$

### 5.3. Уравнения движения

Для ступени РН:
$$
\dot{\mathbf r}*{lv} = \mathbf v*{lv}
$$

$$
\dot{\mathbf v}*{lv} =
-\mu \frac{\mathbf r*{lv}}{|\mathbf r_{lv}|^3}

* \frac{F}{m_{lv}} \mathbf u
  $$

Для КА:
$$
\dot{\mathbf r}*{sc} = \mathbf v*{sc}
$$
$$
\dot{\mathbf v}*{sc} =
-\mu \frac{\mathbf r*{sc}}{|\mathbf r_{sc}|^3}

* \frac{F}{m_{sc}} \mathbf u
 $$ 

---

## 6. Начальные условия

### 6.1. Переход от кеплеровых элементов к ( \mathbf r_0, \mathbf v_0 )

1. Решается **уравнение Кеплера**:
   
   $$M = E - e \sin E$$
   
2. Находятся радиус и истинная аномалия:
   
   $$r = a(1 - e \cos E)$$
   
3. В PQW:
   
   $$\mathbf r_{pqw} =
   \begin{bmatrix}
   r \cos \nu \ r \sin \nu \ 0
   \end{bmatrix},
   \quad
   \mathbf v_{pqw} =
   \sqrt{\frac{\mu}{p}}
   \begin{bmatrix}
   -\sin \nu \ e + \cos \nu \ 0
   \end{bmatrix}$$
   
4. Поворот PQW → ECI:
  $$ 
   \mathbf r_0 = Q \mathbf r_{pqw}, \quad
   \mathbf v_0 = Q \mathbf v_{pqw}
   $$

### 6.2. Начальное состояние системы

* ($\mathbf r_{lv}(0) = \mathbf r_0$)
* ($\mathbf v_{lv}(0) = \mathbf v_0$)
* ($\mathbf r_{sc}(0) = \mathbf r_0 + L_0 \mathbf u$)
* ($\mathbf v_{sc}(0) = \mathbf v_0$)

---

## 7. Этапы численного расчёта

1. Задание всех входных параметров (орбита, массы, пружина).
2. Перевод кеплеровых элементов в векторы ( \mathbf r_0, \mathbf v_0 ).
3. Формирование начального состояния системы из 12 переменных.
4. Численное интегрирование ОДУ на интервале 0–5 с.
5. Вычисление:

   * относительного расстояния
   * относительной скорости
   * силы толкателя
6. Экспорт результатов в CSV.
7. Построение графиков.

---

## 8. Ключевые функции и их назначение

| Функция          | Назначение                                      |
| ---------------- | ----------------------------------------------- |
| `kepler_E.m`     | Решение уравнения Кеплера                       |
| `kepler2rv.m`    | Переход от элементов к ( \mathbf r, \mathbf v ) |
| `rhs_sep.m`      | Правая часть системы ОДУ                        |
| `spring_force.m` | Расчёт силы толкателя                           |
| `postprocess.m`  | Анализ и построение графиков                    |
| `export_csv.m`   | Сохранение результатов в CSV                    |
| `run.m`          | Главный скрипт запуска                          |

---

## 9. Результаты моделирования

В результате работы программы формируются:

* временные ряды положений и скоростей КА и РН;
* относительное расстояние и скорость;
* сила толкателя;
* CSV-файл с шагом 0.01 с;
* графики траекторий и временных зависимостей.

---

## 10. Соответствие требованиям ТЗ

* ✔ Используется временной закон силы, а не импульс
* ✔ Численное интегрирование уравнений движения
* ✔ Шаг вывода не превышает 0.01 с
* ✔ Результаты представлены в CSV и в графическом виде
* ✔ Модель физически интерпретируема и расширяема

---
